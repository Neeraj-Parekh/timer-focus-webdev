<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0F172A">
    <meta name="description" content="Focus Timer Pro - AI-Powered Productivity System for ADHD & Deep Work">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Focus Timer">

    <title>Focus Timer Pro</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Favicon & Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body>
    <!-- App Shell -->
    <div id="app" class="app-container">

        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button id="menu-btn" class="icon-btn" aria-label="Menu">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h1 class="app-title">Focus Timer</h1>
            </div>
            <div class="header-right">
                <button id="stats-btn" class="icon-btn" aria-label="Statistics">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 20V10M12 20V4M6 20v-6"></path>
                    </svg>
                </button>
                <button id="settings-btn" class="icon-btn" aria-label="Settings">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main id="main-content" class="main-content">

            <!-- Home View (default) -->
            <section id="view-home" class="view active">

                <!-- Timer Display -->
                <div class="timer-container">
                    <div id="timer-display" class="timer-display">
                        <div class="timer-ring">
                            <svg class="timer-svg" viewBox="0 0 200 200">
                                <defs>
                                    <linearGradient id="timer-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#3B82F6" />
                                        <stop offset="100%" stop-color="#8B5CF6" />
                                    </linearGradient>
                                </defs>
                                <circle class="timer-bg" cx="100" cy="100" r="90" />
                                <circle id="timer-progress" class="timer-progress" cx="100" cy="100" r="90" />
                            </svg>
                            <div class="timer-inner">
                                <span id="timer-time" class="timer-time">25:00</span>
                                <span id="timer-task" class="timer-task">Select a task</span>
                            </div>
                        </div>
                    </div>

                    <!-- Timer Controls -->
                    <div class="timer-controls">
                        <button id="btn-skip-prev" class="control-btn secondary" aria-label="Previous task">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z" />
                            </svg>
                        </button>
                        <button id="btn-play-pause" class="control-btn primary" aria-label="Start/Pause">
                            <svg id="icon-play" width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8 5v14l11-7z" />
                            </svg>
                            <svg id="icon-pause" width="32" height="32" viewBox="0 0 24 24" fill="currentColor"
                                style="display: none;">
                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                            </svg>
                        </button>
                        <button id="btn-skip-next" class="control-btn secondary" aria-label="Next task">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" />
                            </svg>
                        </button>
                        <button id="btn-stop" class="control-btn danger" aria-label="Stop">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 6h12v12H6z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Current Session Info -->
                <div id="session-info" class="session-info">
                    <div class="session-stat">
                        <span class="stat-value" id="session-completed">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                    <div class="session-stat">
                        <span class="stat-value" id="session-time">0m</span>
                        <span class="stat-label">Focus Time</span>
                    </div>
                    <div class="session-stat">
                        <span class="stat-value" id="session-remaining">0</span>
                        <span class="stat-label">Remaining</span>
                    </div>
                </div>

                <!-- Task Queue -->
                <div class="task-queue-section">
                    <div class="section-header">
                        <h2>Task Queue</h2>
                        <button id="btn-add-task" class="btn-add" aria-label="Add task">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Add Task
                        </button>
                    </div>
                    <div id="task-queue" class="task-queue">
                        <!-- Tasks will be rendered here -->
                        <div class="empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="9" y1="9" x2="15" y2="15"></line>
                                <line x1="15" y1="9" x2="9" y2="15"></line>
                            </svg>
                            <p>No tasks yet. Add your first task!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Task List View -->
            <section id="view-tasks" class="view">
                <div class="view-header">
                    <h2>All Tasks</h2>
                </div>
                <div id="task-list" class="task-list">
                    <!-- Full task list -->
                </div>
            </section>

            <!-- Statistics View -->
            <section id="view-stats" class="view">
                <div class="view-header">
                    <h2>Statistics</h2>
                </div>
                <div class="stats-container">
                    <div class="stats-card">
                        <h3>Today</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-value" id="stat-today-time">0h 0m</span>
                                <span class="stat-label">Focus Time</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-today-tasks">0</span>
                                <span class="stat-label">Tasks Done</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <h3>Streak</h3>
                        <div class="streak-display">
                            <span class="streak-count" id="stat-streak">0</span>
                            <span class="streak-label">days</span>
                        </div>
                    </div>
                    <div class="stats-card">
                        <h3>Last 7 Days</h3>
                        <div id="chart-weekly" class="chart-container">
                            <!-- Bar chart will be rendered here -->
                        </div>
                    </div>
                    <div class="stats-card stats-card-full">
                        <h3>Activity Calendar</h3>
                        <div id="calendar-heatmap" class="heatmap-wrapper">
                            <!-- Heatmap will be rendered here -->
                        </div>
                    </div>
                    <div class="stats-card stats-card-full">
                        <h3>Detailed Analysis</h3>
                        <div id="advanced-stats-container">
                            <!-- Advanced stats will be rendered here -->
                        </div>
                    </div>
                    <div class="stats-card">
                        <h3>Export Data</h3>
                        <div class="export-actions">
                            <button id="btn-export-csv" class="btn btn-secondary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                Export CSV
                            </button>
                            <button id="btn-session-summary" class="btn btn-secondary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                                Session Summary
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="view-settings" class="view">
                <div class="view-header">
                    <h2>Settings</h2>
                </div>
                <div class="settings-container">
                    <div class="settings-group">
                        <h3>Appearance</h3>
                        <div class="setting-item">
                            <div id="theme-selector"></div>
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Timer</h3>
                        <div class="setting-item">
                            <label for="setting-timer-style">Timer Style</label>
                            <select id="setting-timer-style">
                                <option value="circular">Circular Progress</option>
                                <option value="analog">Analog Clock</option>
                                <option value="linear">Linear Bar</option>
                                <option value="digital">Digital</option>
                                <option value="flip">Flip Clock (Retro)</option>
                                <option value="nixie">Nixie Tube (Glass)</option>
                                <option value="hourglass">Pixel Hourglass</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="setting-default-duration">Default Duration (min)</label>
                            <input type="number" id="setting-default-duration" value="25" min="1" max="120">
                        </div>
                        <div class="setting-item toggle">
                            <label for="setting-keep-screen-on">Keep Screen On</label>
                            <div class="toggle-wrapper">
                                <span class="toggle-hint">Prevent sleep while running</span>
                                <input type="checkbox" id="setting-keep-screen-on" checked>
                            </div>
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Sound</h3>
                        <div class="setting-item">
                            <label for="setting-alert-sound">Alert Sound</label>
                            <select id="setting-alert-sound">
                                <option value="bell">Bell</option>
                                <option value="chime">Chime</option>
                                <option value="ding">Ding</option>
                                <option value="sweep">FM Sweep</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="setting-volume">Volume</label>
                            <input type="range" id="setting-volume" min="0" max="100" value="80">
                        </div>
                        <div class="setting-item toggle">
                            <label for="setting-vibrate">Vibration</label>
                            <input type="checkbox" id="setting-vibrate" checked>
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Rotation Templates</h3>
                        <div class="setting-item">
                            <div id="template-selector">
                                <!-- Templates rendered by JS -->
                            </div>
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Audio Masking</h3>
                        <div class="setting-item">
                            <label for="setting-noise-type">Background Noise</label>
                            <select id="setting-noise-type">
                                <option value="none">None</option>
                                <option value="white">White Noise</option>
                                <option value="pink">Pink Noise</option>
                                <option value="brown">Brown Noise</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="setting-noise-volume">Noise Volume</label>
                            <input type="range" id="setting-noise-volume" min="0" max="100" value="30">
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Ambient Sounds</h3>
                        <div class="setting-item">
                            <label for="setting-ambient-rain">üåßÔ∏è Rain</label>
                            <input type="range" id="setting-ambient-rain" min="0" max="100" value="0"
                                data-ambient="rain">
                        </div>
                        <div class="setting-item">
                            <label for="setting-ambient-coffee">‚òï Coffee Shop</label>
                            <input type="range" id="setting-ambient-coffee" min="0" max="100" value="0"
                                data-ambient="coffeeShop">
                        </div>
                        <div class="setting-item">
                            <label for="setting-ambient-fire">üî• Fireplace</label>
                            <input type="range" id="setting-ambient-fire" min="0" max="100" value="0"
                                data-ambient="fireplace">
                        </div>
                        <div class="setting-item">
                            <label for="setting-ambient-forest">üå≤ Forest</label>
                            <input type="range" id="setting-ambient-forest" min="0" max="100" value="0"
                                data-ambient="forest">
                        </div>
                    </div>
                    <div class="settings-group">
                        <h3>Pomodoro Timer</h3>
                        <div class="setting-item">
                            <label for="setting-work-duration">Work Duration (min)</label>
                            <input type="number" id="setting-work-duration" value="25" min="5" max="90">
                        </div>
                        <div class="setting-item">
                            <label for="setting-short-break">Short Break (min)</label>
                            <input type="number" id="setting-short-break" value="5" min="1" max="30">
                        </div>
                        <div class="setting-item">
                            <label for="setting-long-break">Long Break (min)</label>
                            <input type="number" id="setting-long-break" value="15" min="5" max="60">
                        </div>
                        <div class="setting-item">
                            <label for="setting-sessions-until-long">Sessions Until Long Break</label>
                            <input type="number" id="setting-sessions-until-long" value="4" min="2" max="10">
                        </div>
                        <div class="setting-item toggle">
                            <label for="setting-auto-break">Auto-start Breaks</label>
                            <input type="checkbox" id="setting-auto-break" checked>
                        </div>
                        <div class="setting-item">
                            <label for="setting-break-sound">Break Sound</label>
                            <select id="setting-break-sound">
                                <option value="chime" selected>Chime</option>
                                <option value="bell">Bell</option>
                                <option value="ding">Ding</option>
                                <option value="sweep">FM Sweep</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="settings-group">
                    <h3>Integrations</h3>
                    <div class="setting-item">
                        <label>TickTick Sync</label>
                        <div class="flex flex-col gap-2 w-full">
                            <p class="text-xs text-muted">Enter your TickTick Calendar URL (ICS) or API Token to sync
                                tasks.</p>
                            <input type="text" id="setting-ticktick-token" placeholder="Paste ICS URL or Token here..."
                                class="w-full">
                            <div class="flex gap-2 mt-2">
                                <button id="btn-sync-ticktick" class="btn btn-primary flex-1"
                                    style="justify-content: center;">
                                    <span class="material-symbols-rounded"
                                        style="font-size: 18px; margin-right: 6px;">sync</span>
                                    Sync Now
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="settings-group">
                    <h3>Data Management</h3>
                    <div class="setting-item">
                        <label>Backup & Restore</label>
                        <div class="flex gap-2">
                            <button id="btn-backup-data" class="btn btn-secondary flex-1"
                                style="justify-content: center;">
                                <span class="material-symbols-rounded"
                                    style="font-size: 18px; margin-right: 6px;">download</span>
                                Backup
                            </button>
                            <button id="btn-restore-data" class="btn btn-secondary flex-1"
                                style="justify-content: center;">
                                <span class="material-symbols-rounded"
                                    style="font-size: 18px; margin-right: 6px;">upload</span>
                                Restore
                            </button>
                            <input type="file" id="file-restore-data" accept=".json" style="display: none;">
                        </div>
                        <p class="text-xs text-muted mt-2">Export your data to a JSON file or restore from a backup.
                        </p>
                    </div>
                    <div class="setting-item">
                        <label>ML Training Data</label>
                        <div class="flex gap-2">
                            <button id="btn-export-ml-data" class="btn btn-secondary flex-1"
                                style="justify-content: center;">
                                <span class="material-symbols-rounded"
                                    style="font-size: 18px; margin-right: 6px;">analytics</span>
                                Export CSV
                            </button>
                        </div>
                        <p class="text-xs text-muted mt-2">Export task metrics, session data & daily state as CSV for ML
                            training.</p>
                    </div>
                </div>
    </div>
    </section>

    <!-- Eisenhower Matrix View -->
    <section id="view-matrix" class="view">
        <!-- Matrix will be rendered by JS -->
    </section>

    <!-- Folders View -->
    <section id="view-folders" class="view">
        <!-- Folders will be rendered by JS -->
    </section>

    </main>

    <!-- Floating Action Button (Brain Dump) -->
    <button id="fab-braindump" class="fab" aria-label="Quick capture">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5"></path>
            <path d="M2 12l10 5 10-5"></path>
        </svg>
    </button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-view="home">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <span>Timer</span>
        </button>
        <button class="nav-item" data-view="tasks">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 11l3 3L22 4"></path>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
            <span>Tasks</span>
        </button>
        <button class="nav-item" data-view="matrix">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            <span>Matrix</span>
        </button>
        <button class="nav-item" data-view="folders">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            <span>Folders</span>
        </button>
    </nav>

    </div>

    <!-- Task Modal -->
    <div id="modal-task" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-task-title">Add Task</h3>
                <button class="modal-close" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="form-task" class="modal-body">
                <input type="hidden" id="task-id">
                <div class="form-group">
                    <label for="task-name">Task Name</label>
                    <input type="text" id="task-name" placeholder="What are you working on?" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-duration">Duration (min)</label>
                        <input type="number" id="task-duration" value="25" min="1" max="180">
                    </div>
                    <div class="form-group">
                        <label for="task-priority">Priority</label>
                        <select id="task-priority">
                            <option value="1">üî¥ Urgent & Important</option>
                            <option value="2">üü† Important</option>
                            <option value="3">üîµ Urgent</option>
                            <option value="4" selected>‚ö™ Normal</option>
                        </select>
                    </div>
                </div>
                <!-- Task Goal Settings -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-target-sessions">Check completion after</label>
                        <div class="flex items-center" style="gap: 8px;">
                            <input type="number" id="task-target-sessions" value="0" min="0" max="20"
                                style="width: 80px;">
                            <span class="text-xs text-muted">sessions (0 = off)</span>
                        </div>
                    </div>
                </div>

                <!-- ML Data Collection Fields -->
                <details class="ml-data-section">
                    <summary class="ml-data-toggle">üìä Task Details (for learning)</summary>
                    <div class="ml-data-fields">
                        <div class="form-group">
                            <label for="task-importance">Importance</label>
                            <div class="slider-with-labels">
                                <input type="range" id="task-importance" min="0" max="100" value="50"
                                    class="slider-input">
                                <div class="slider-labels">
                                    <span>Optional</span>
                                    <span>Moderate</span>
                                    <span>Critical</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="task-cognitive">Mental Effort Needed</label>
                            <div class="slider-with-labels">
                                <input type="range" id="task-cognitive" min="0" max="100" value="50"
                                    class="slider-input">
                                <div class="slider-labels">
                                    <span>üò¥ Easy</span>
                                    <span>ü§î Medium</span>
                                    <span>ü§Ø Hard</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="task-deadline">Deadline (optional)</label>
                                <input type="date" id="task-deadline">
                            </div>
                            <div class="form-group">
                                <label for="task-optionality">Unlocks tasks</label>
                                <input type="number" id="task-optionality" value="0" min="0" max="10"
                                    placeholder="How many?">
                            </div>
                        </div>
                    </div>
                </details>
                <div class="form-group">
                    <label for="task-folder">Folder</label>
                    <select id="task-folder">
                        <option value="inbox">üì• Inbox</option>
                        <option value="academic">üìö Academic</option>
                        <option value="projects">üíª Projects</option>
                        <option value="personal">üè† Personal</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Color</label>
                    <input type="hidden" id="task-color" value="#2196F3">
                    <div class="color-picker" id="task-color-picker">
                        <!-- Style Guide Colors -->
                        <button type="button" class="color-option active" data-color="#2196F3"
                            style="background: #2196F3" aria-label="Blue"></button>
                        <button type="button" class="color-option" data-color="#E91E63" style="background: #E91E63"
                            aria-label="Pink"></button>
                        <button type="button" class="color-option" data-color="#4CAF50" style="background: #4CAF50"
                            aria-label="Green"></button>
                        <button type="button" class="color-option" data-color="#FF9800" style="background: #FF9800"
                            aria-label="Orange"></button>
                        <button type="button" class="color-option" data-color="#00BCD4" style="background: #00BCD4"
                            aria-label="Cyan"></button>

                        <!-- Additional Vibrant Colors -->
                        <button type="button" class="color-option" data-color="#673AB7" style="background: #673AB7"
                            aria-label="Deep Purple"></button>
                        <button type="button" class="color-option" data-color="#9C27B0" style="background: #9C27B0"
                            aria-label="Purple"></button>
                        <button type="button" class="color-option" data-color="#3F51B5" style="background: #3F51B5"
                            aria-label="Indigo"></button>
                        <button type="button" class="color-option" data-color="#009688" style="background: #009688"
                            aria-label="Teal"></button>
                        <button type="button" class="color-option" data-color="#CDDC39" style="background: #CDDC39"
                            aria-label="Lime"></button>
                        <button type="button" class="color-option" data-color="#795548" style="background: #795548"
                            aria-label="Brown"></button>
                        <button type="button" class="color-option" data-color="#607D8B" style="background: #607D8B"
                            aria-label="Blue Grey"></button>
                    </div>
                </div>
        </div>
        </form>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
            <button type="submit" form="form-task" class="btn btn-primary">Save Task</button>
        </div>
    </div>
    </div>

    <!-- Quick Capture Modal -->
    <div id="modal-braindump" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-compact">
            <div class="modal-header">
                <h3>Quick Capture</h3>
                <button class="modal-close" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="form-braindump" class="modal-body">
                <div class="form-group">
                    <textarea id="braindump-text" placeholder="Quick thought, reminder, or task..." rows="3"></textarea>
                </div>
            </form>
            <div class="modal-footer">
                <button type="submit" form="form-braindump" class="btn btn-primary btn-full">Save to Inbox</button>
            </div>
        </div>
    </div>

    <!-- Session Summary Modal -->
    <div id="modal-session-summary" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-summary-title">Session Complete!</h3>
                <button class="modal-close" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div id="session-summary-content" class="modal-body">
                <!-- Summary will be rendered by JS -->
            </div>
            <div class="modal-footer">
                <button id="btn-end-session" class="btn btn-secondary">End Session</button>
                <button id="btn-continue-session" class="btn btn-primary">Continue Working</button>
            </div>
        </div>
    </div>

    <!-- Post-Completion Survey Modal -->
    <div id="modal-completion-survey" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-compact">
            <div class="modal-header">
                <h3>üéâ Great job!</h3>
                <button class="modal-close" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p id="survey-task-name" class="text-muted mb-4">Task completed</p>

                <div class="survey-question">
                    <label>How valuable was this? (ROI)</label>
                    <div class="star-rating" id="survey-roi">
                        <button type="button" data-value="1" aria-label="1 star">‚≠ê</button>
                        <button type="button" data-value="2" aria-label="2 stars">‚≠ê</button>
                        <button type="button" data-value="3" aria-label="3 stars">‚≠ê</button>
                        <button type="button" data-value="4" aria-label="4 stars">‚≠ê</button>
                        <button type="button" data-value="5" aria-label="5 stars">‚≠ê</button>
                    </div>
                </div>

                <div class="survey-question">
                    <label>Difficulty compared to expected?</label>
                    <div class="difficulty-scale" id="survey-difficulty">
                        <button type="button" data-value="1">üòå Much Easier</button>
                        <button type="button" data-value="2">üôÇ Easier</button>
                        <button type="button" data-value="3" class="active">üòê As Expected</button>
                        <button type="button" data-value="4">üòì Harder</button>
                        <button type="button" data-value="5">üò∞ Much Harder</button>
                    </div>
                </div>

                <div class="survey-question">
                    <label>How satisfied are you?</label>
                    <div class="emoji-rating" id="survey-satisfaction">
                        <button type="button" data-value="1">üòû</button>
                        <button type="button" data-value="2">üòï</button>
                        <button type="button" data-value="3">üòê</button>
                        <button type="button" data-value="4" class="active">üôÇ</button>
                        <button type="button" data-value="5">üòÑ</button>
                    </div>
                </div>

                <div class="form-group mt-4">
                    <input type="text" id="survey-notes" placeholder="Quick note (optional)" class="w-full">
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-skip-survey" class="btn btn-ghost">Skip</button>
                <button id="btn-submit-survey" class="btn btn-primary">Submit & Continue</button>
            </div>
        </div>
    </div>

    <!-- Morning Energy Prompt (Bottom Sheet) -->
    <div id="modal-morning-prompt" class="modal bottom-sheet">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚òÄÔ∏è Good morning!</h3>
                <button class="modal-close" aria-label="Close">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="text-muted mb-4">How's your energy level today?</p>
                <div class="energy-slider-container">
                    <input type="range" id="morning-energy" min="0" max="5" value="3" class="energy-slider">
                    <div class="energy-labels">
                        <span>üò¥</span>
                        <span>üò™</span>
                        <span>üôÇ</span>
                        <span>üòä</span>
                        <span>üí™</span>
                        <span>ü§©</span>
                    </div>
                </div>
                <div class="form-group mt-4">
                    <label>Hours of sleep (optional)</label>
                    <input type="number" id="morning-sleep" min="0" max="12" step="0.5" placeholder="e.g. 7">
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-save-morning" class="btn btn-primary btn-full">Let's go! üí™</button>
            </div>
        </div>
    </div>

    <!-- Evening Check-in Prompt -->
    <div id="modal-evening-prompt" class="modal bottom-sheet">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>üåô End of day check-in</h3>
                <button class="modal-close" aria-label="Close">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="evening-stats" class="stats-summary mb-4"></div>

                <div class="survey-question">
                    <label>Energy level now?</label>
                    <div class="energy-slider-container">
                        <input type="range" id="evening-energy" min="0" max="5" value="3" class="energy-slider">
                        <div class="energy-labels">
                            <span>üò¥</span><span>üò™</span><span>üôÇ</span><span>üòä</span><span>üí™</span><span>ü§©</span>
                        </div>
                    </div>
                </div>

                <div class="survey-question">
                    <label>How tired are you?</label>
                    <div class="fatigue-scale">
                        <input type="range" id="evening-fatigue" min="0" max="100" value="50" class="slider-input">
                        <div class="slider-labels">
                            <span>Fresh üí™</span>
                            <span>Normal</span>
                            <span>Exhausted üò¥</span>
                        </div>
                    </div>
                </div>

                <div class="survey-question">
                    <label>Quality of breaks today?</label>
                    <div class="star-rating" id="evening-rest-quality">
                        <button type="button" data-value="1">‚≠ê</button>
                        <button type="button" data-value="2">‚≠ê</button>
                        <button type="button" data-value="3" class="active">‚≠ê</button>
                        <button type="button" data-value="4">‚≠ê</button>
                        <button type="button" data-value="5">‚≠ê</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-save-evening" class="btn btn-primary btn-full">Done for today ‚úÖ</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- PWA Install Prompt -->
    <div id="install-prompt" class="install-prompt hidden">
        <div class="install-content">
            <span>Install Focus Timer for a better experience!</span>
            <button id="install-btn" class="btn btn-small btn-primary">Install</button>
            <button id="install-dismiss" class="btn btn-small btn-ghost">Later</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/matrix.js"></script>
    <script src="js/folders.js"></script>
    <script src="js/ambient.js"></script>
    <script src="js/heatmap.js"></script>
    <script src="js/pomodoro.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/themes.js"></script>
    <script src="js/shortcuts.js"></script>
    <script src="js/timers/styles.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/ticktick.js"></script>
    <script src="js/datacollection.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW registered:', reg.scope))
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
</body>

</html>